{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\SidWonder\\\\Documents\\\\auth\\\\src\\\\components\\\\App.js\",\n    _s = $RefreshSig$();\n\nimport React from 'react';\nimport { Route, Switch, Redirect } from 'react-router-dom';\nimport Header from './Header.js';\nimport { Main } from './Main.js';\nimport Footer from './Footer.js';\nimport PopupWithForm from './PopupWithForm';\nimport EditProfilePopup from './EditProfilePopup';\nimport AddPlacePopup from './AddPlacePopup';\nimport ImagePopup from './ImagePopup';\nimport EditAvatarPopup from './EditAvatarPopup';\nimport { CurrentUserContext } from '../contexts/CurrentUserContext';\nimport '../index.css';\nimport api from '../utils/api';\nimport Register from './Register';\nimport Login from './Login';\nimport ProtectedRoute from './ProtectedRoute';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction App() {\n  _s();\n\n  const [isEditAvatarPopupOpen, setAvatarPopupOpen] = React.useState(false);\n  const [isEditProfilePopupOpen, setPopupProfileState] = React.useState(false);\n  const [isAddPlacePopupOpen, setAddPlacePopupOpen] = React.useState(false);\n  const [selectedCard, setSelectedCard] = React.useState({});\n  const [currentUser, setCurrentUser] = React.useState({});\n  const [cards, setCards] = React.useState([]);\n  const [isLoggedIn, setLogged] = React.useState(false);\n  const [userInfo, setUserInfo] = React.useState({});\n  React.useEffect(() => {\n    async function fetchData() {\n      const userInfo = await api.getUserInfo();\n      return userInfo;\n    }\n\n    fetchData().then(data => setCurrentUser(data)).catch(err => console.log(err));\n  }, []);\n  React.useEffect(() => {\n    async function fetchData() {\n      const cardsData = await api.getCards();\n      return cardsData;\n    }\n\n    fetchData().then(data => setCards(data)).catch(err => console.log(err));\n  }, []);\n\n  function handleEditAvatarClick() {\n    setAvatarPopupOpen(true);\n  }\n\n  function handleEditProfileClick() {\n    setPopupProfileState(true);\n  }\n\n  function handleAddPlaceClick() {\n    setAddPlacePopupOpen(true);\n  }\n\n  function handleCardClick(card) {\n    setSelectedCard(card);\n  }\n\n  function handleCloseAll() {\n    setPopupProfileState(false);\n    setAvatarPopupOpen(false);\n    setAddPlacePopupOpen(false);\n    setSelectedCard({});\n  }\n\n  function handleUpdateUser(userData) {\n    api.setUserInfo(userData).then(data => {\n      setCurrentUser(data);\n    }).catch(err => {\n      console.log(err);\n    });\n    handleCloseAll();\n  }\n\n  function handleUpdateAvatar(userData) {\n    console.log(userData);\n    api.setUserAvatar(userData).then(data => {\n      setCurrentUser(data);\n    }).catch(err => {\n      console.log(err);\n    });\n    handleCloseAll();\n  }\n\n  function handleCardLike(card) {\n    // Снова проверяем, есть ли уже лайк на этой карточке\n    const isLiked = card.likes.some(i => i._id === currentUser._id);\n\n    if (!isLiked) {\n      api.addLike(card).then(newCard => {\n        setCards(state => state.map(c => c._id === card._id ? newCard : c));\n      }).catch(err => {\n        console.log(err);\n      });\n    } else {\n      api.deleteLike(card).then(newCard => {\n        setCards(state => state.map(c => c._id === card._id ? newCard : c));\n      }).catch(err => {\n        console.log(err);\n      });\n    }\n  }\n\n  function handleCardDelete(card) {\n    api.deleteCard(card).then(() => {\n      setCards(cards.filter(item => item._id !== card._id));\n    }).catch(err => {\n      console.log(err);\n    });\n  }\n\n  function handleAddPlace(placeData) {\n    api.addNewCard(placeData).then(data => {\n      setCards([data, ...cards]);\n    }).catch(err => {\n      console.log(err);\n    });\n    handleCloseAll();\n  }\n\n  console.log('dsdf');\n  return /*#__PURE__*/_jsxDEV(CurrentUserContext.Provider, {\n    value: currentUser,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"page__content\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"page\",\n        children: [/*#__PURE__*/_jsxDEV(Header, {\n          isLoggedIn: isLoggedIn,\n          setLogged: setLogged,\n          userInfo: userInfo,\n          setUserInfo: setUserInfo\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(Switch, {\n          children: [/*#__PURE__*/_jsxDEV(Route, {\n            path: \"/sign-up\",\n            children: /*#__PURE__*/_jsxDEV(Register, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 129,\n              columnNumber: 8\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 128,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(Route, {\n            path: \"/sign-in\",\n            children: /*#__PURE__*/_jsxDEV(Login, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 132,\n              columnNumber: 8\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 131,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(ProtectedRoute, {\n            children: [\"path='/' component=\", Main, \"isLoggedIn=\", isLoggedIn, \"onEditAvatar=\", handleEditAvatarClick, \"onEditProfile=\", handleEditProfileClick, \"onAddPlace=\", handleAddPlaceClick, \"onCardClick=\", handleCardClick, \"cards=\", cards, \"onCardDelete=\", handleCardDelete, \"onCardLike=\", handleCardLike]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 134,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(Route, {\n            children: isLoggedIn ? /*#__PURE__*/_jsxDEV(Redirect, {\n              to: \"/\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 147,\n              columnNumber: 28\n            }, this) : /*#__PURE__*/_jsxDEV(Redirect, {\n              to: \"/sign-in\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 147,\n              columnNumber: 50\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 147,\n            columnNumber: 7\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 6\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(EditProfilePopup, {\n        isOpen: isEditProfilePopupOpen,\n        closeIt: handleCloseAll,\n        onUpdateUser: handleUpdateUser\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(EditAvatarPopup, {\n        isOpen: isEditAvatarPopupOpen,\n        closeIt: handleCloseAll,\n        onUpdateAvatar: handleUpdateAvatar\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(AddPlacePopup, {\n        isOpen: isAddPlacePopupOpen,\n        closeIt: handleCloseAll,\n        onUpdatePlace: handleAddPlace\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(PopupWithForm, {\n        name: \"popup-confirm\",\n        title: \"\\u0412\\u044B \\u0443\\u0432\\u0435\\u0440\\u0435\\u043D\\u044B?\",\n        buttonText: \"\\u0414\\u0430\",\n        isOpen: false,\n        closeIt: handleCloseAll,\n        children: /*#__PURE__*/_jsxDEV(_Fragment, {}, void 0, false)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 5\n      }, this), selectedCard._id && /*#__PURE__*/_jsxDEV(ImagePopup, {\n        card: selectedCard,\n        closeIt: handleCloseAll\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 26\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 4\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 119,\n    columnNumber: 3\n  }, this);\n}\n\n_s(App, \"U42i7GOjc6fonzFQ5fU7wGq6Dzw=\");\n\n_c = App;\nexport default App;\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"sources":["C:/Users/SidWonder/Documents/auth/src/components/App.js"],"names":["React","Route","Switch","Redirect","Header","Main","Footer","PopupWithForm","EditProfilePopup","AddPlacePopup","ImagePopup","EditAvatarPopup","CurrentUserContext","api","Register","Login","ProtectedRoute","App","isEditAvatarPopupOpen","setAvatarPopupOpen","useState","isEditProfilePopupOpen","setPopupProfileState","isAddPlacePopupOpen","setAddPlacePopupOpen","selectedCard","setSelectedCard","currentUser","setCurrentUser","cards","setCards","isLoggedIn","setLogged","userInfo","setUserInfo","useEffect","fetchData","getUserInfo","then","data","catch","err","console","log","cardsData","getCards","handleEditAvatarClick","handleEditProfileClick","handleAddPlaceClick","handleCardClick","card","handleCloseAll","handleUpdateUser","userData","handleUpdateAvatar","setUserAvatar","handleCardLike","isLiked","likes","some","i","_id","addLike","newCard","state","map","c","deleteLike","handleCardDelete","deleteCard","filter","item","handleAddPlace","placeData","addNewCard"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport { Route, Switch, Redirect} from 'react-router-dom';\r\nimport Header from './Header.js';\r\nimport {Main} from './Main.js';\r\nimport Footer from './Footer.js';\r\nimport PopupWithForm from './PopupWithForm';\r\nimport EditProfilePopup from './EditProfilePopup';\r\nimport AddPlacePopup from './AddPlacePopup';\r\nimport ImagePopup from './ImagePopup';\r\nimport EditAvatarPopup from './EditAvatarPopup';\r\nimport {CurrentUserContext} from '../contexts/CurrentUserContext';\r\nimport '../index.css';\r\nimport api from '../utils/api';\r\n\r\nimport Register from './Register';\r\nimport Login from './Login';\r\nimport ProtectedRoute from './ProtectedRoute';\r\n\r\nfunction App() {\r\n\r\n\tconst [isEditAvatarPopupOpen, setAvatarPopupOpen] = React.useState(false);\r\n\tconst [isEditProfilePopupOpen, setPopupProfileState] = React.useState(false);\r\n\tconst [isAddPlacePopupOpen, setAddPlacePopupOpen] = React.useState(false);\r\n\tconst [selectedCard, setSelectedCard] = React.useState({});\r\n\r\n\tconst [currentUser, setCurrentUser] = React.useState({});\r\n\tconst [cards, setCards] = React.useState([]);\r\n\r\n\tconst [isLoggedIn, setLogged] = React.useState(false);\r\n\tconst [userInfo, setUserInfo] = React.useState({});\r\n\r\n\tReact.useEffect(() => {\r\n\t\tasync function fetchData() {\r\n\t\t\tconst userInfo = await api.getUserInfo();\r\n\t\t\treturn userInfo;\r\n\t\t}\r\n\t\tfetchData()\r\n\t\t\t.then(data=> setCurrentUser(data))\r\n\t\t\t.catch(err => console.log(err));\r\n\t}, []);\r\n\r\n\tReact.useEffect(() => {\r\n\t\tasync function fetchData() {\r\n\t\t\tconst cardsData = await api.getCards();\r\n\t\t\treturn cardsData;\r\n\t\t}\r\n\t\tfetchData()\r\n\t\t\t.then(data=> setCards(data))\r\n\t\t\t.catch(err => console.log(err));\r\n\t}, []);\r\n\r\n\tfunction handleEditAvatarClick() {\r\n\t\tsetAvatarPopupOpen(true);\r\n\t}\r\n\r\n\tfunction handleEditProfileClick() {\r\n\t\tsetPopupProfileState(true);\r\n\t}\r\n\r\n\tfunction handleAddPlaceClick() {\r\n\t\tsetAddPlacePopupOpen(true);\r\n\t}\r\n\r\n\tfunction handleCardClick(card) {\r\n\t\tsetSelectedCard(card);\r\n\t}\r\n\r\n\tfunction handleCloseAll() {\r\n\t\tsetPopupProfileState(false);\r\n\t\tsetAvatarPopupOpen(false);\r\n\t\tsetAddPlacePopupOpen(false);\r\n\t\tsetSelectedCard({});\r\n\t}\r\n\r\n\tfunction handleUpdateUser(userData) {\r\n\t\tapi.setUserInfo(userData).then((data) => {\r\n\t\t\tsetCurrentUser(data);\r\n\t\t}).catch((err) => { console.log(err); });\r\n\t\thandleCloseAll();\r\n\t}\r\n\r\n\tfunction handleUpdateAvatar(userData) {\r\n\t\tconsole.log(userData);\r\n\t\tapi.setUserAvatar(userData).then((data) => {\r\n\t\t\tsetCurrentUser(data);\r\n\t\t}).catch((err) => { console.log(err); });\r\n\t\thandleCloseAll();\r\n\t}\r\n\r\n\r\n\tfunction handleCardLike(card) {\r\n\t\t// Снова проверяем, есть ли уже лайк на этой карточке\r\n\t\tconst isLiked = card.likes.some(i => i._id === currentUser._id);\r\n\t\tif (!isLiked) {\r\n\t\t\tapi.addLike(card).then((newCard) => {\r\n\t\t\t\tsetCards((state) => state.map((c) => c._id === card._id ? newCard : c));\r\n\t\t\t}).catch((err) => { console.log(err); });\r\n\t\t} else {\r\n\t\t\tapi.deleteLike(card).then((newCard) => {\r\n\t\t\t\tsetCards((state) => state.map((c) => c._id === card._id ? newCard : c));\r\n\t\t\t}).catch((err) => { console.log(err); });\r\n\t\t}\r\n\t}\r\n\r\n\tfunction handleCardDelete(card) {\r\n\t\tapi.deleteCard(card).then(() => {\r\n\t\t\tsetCards(cards.filter((item) => item._id !== card._id));\r\n\t\t}).catch((err) => { console.log(err); });\r\n\t}\r\n\r\n\tfunction handleAddPlace(placeData) {\r\n\t\tapi.addNewCard(placeData).then((data) => {\r\n\t\t\tsetCards([data, ...cards]);\r\n\t\t}).catch((err) => { console.log(err); });\r\n\t\thandleCloseAll();\r\n\t}\r\n\tconsole.log('dsdf');\r\n\treturn (\r\n\t\t<CurrentUserContext.Provider value={currentUser}>\r\n\t\t\t<div className=\"page__content\">\r\n\t\t\t\t<div className=\"page\">\r\n\t\t\t\t\t<Header \r\n\t\t\t\t\t\tisLoggedIn={isLoggedIn}\r\n\t\t\t\t\t\tsetLogged={setLogged}\r\n\t\t\t\t\t\tuserInfo={userInfo}\r\n\t\t\t\t\t\tsetUserInfo={setUserInfo}/>\r\n\t\t\t\t\t<Switch>\r\n\t\t\t\t\t\t<Route path='/sign-up'>\r\n\t\t\t\t\t\t\t<Register/>\r\n\t\t\t\t\t\t</Route>\r\n\t\t\t\t\t\t<Route path='/sign-in'>\r\n\t\t\t\t\t\t\t<Login/>\r\n\t\t\t\t\t\t</Route>\r\n\t\t\t\t\t\t<ProtectedRoute>\r\n\t\t\t\t\t\t\t{/* eslint-disable-next-line react/no-unescaped-entities */}\r\n                            path='/'\r\n                            component={Main}\r\n                            isLoggedIn={isLoggedIn}\r\n                            onEditAvatar={handleEditAvatarClick}\r\n                            onEditProfile={handleEditProfileClick}\r\n                            onAddPlace={handleAddPlaceClick}\r\n                            onCardClick={handleCardClick}\r\n                            cards={cards}\r\n                            onCardDelete={handleCardDelete}\r\n                            onCardLike={handleCardLike}\r\n\t\t\t\t\t\t</ProtectedRoute>\r\n\t\t\t\t\t\t<Route>{isLoggedIn ? <Redirect to='/' /> : <Redirect to='/sign-in' />}</Route>\r\n\t\t\t\t\t</Switch>\r\n\t\t\t\t\t<Footer/>\r\n\t\t\t\t</div>\r\n\t\t\t\t<EditProfilePopup\r\n\t\t\t\t\tisOpen={isEditProfilePopupOpen}\r\n\t\t\t\t\tcloseIt={handleCloseAll}\r\n\t\t\t\t\tonUpdateUser={handleUpdateUser}\r\n\t\t\t\t/>\r\n\t\t\t\t<EditAvatarPopup\r\n\t\t\t\t\tisOpen={isEditAvatarPopupOpen}\r\n\t\t\t\t\tcloseIt={handleCloseAll}\r\n\t\t\t\t\tonUpdateAvatar={handleUpdateAvatar}\r\n\t\t\t\t/>\r\n\t\t\t\t<AddPlacePopup\r\n\t\t\t\t\tisOpen={isAddPlacePopupOpen}\r\n\t\t\t\t\tcloseIt={handleCloseAll}\r\n\t\t\t\t\tonUpdatePlace={handleAddPlace}\r\n\t\t\t\t/>\r\n\t\t\t\t<PopupWithForm name='popup-confirm'\r\n\t\t\t\t\ttitle='Вы уверены?'\r\n\t\t\t\t\tbuttonText='Да'\r\n\t\t\t\t\tisOpen={false}\r\n\t\t\t\t\tcloseIt={handleCloseAll}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\tchildren={<>\r\n\t\t\t\t\t</>}\r\n\t\t\t\t/>\r\n\t\t\t\t{selectedCard._id && <ImagePopup card={selectedCard} closeIt={handleCloseAll}/>}\r\n\t\t\t</div>\r\n\t\t</CurrentUserContext.Provider>\r\n\t);\r\n}\r\n\r\nexport default App;\r\n"]},"metadata":{},"sourceType":"module"}